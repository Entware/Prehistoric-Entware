--- ../../../downloads/openwrt_trunk-r46338/feeds/packages/net/snort/Makefile	2015-07-14 10:55:19.806308173 +0300
+++ ../../../openwrt_trunk/feeds/packages/net/snort/Makefile	2015-07-14 16:52:20.642666686 +0300
@@ -49,16 +49,16 @@
 endef
 
 CONFIGURE_ARGS += \
-	--prefix="/usr" \
+	--prefix="/Apps/opt" \
 	--enable-flexresp \
-	--with-dnet-includes="$(STAGING_DIR)/usr/include" \
-	--with-dnet-libraries="$(STAGING_DIR)/usr/lib" \
-	--with-libpcap-includes="$(STAGING_DIR)/usr/include" \
-	--with-libpcap-libraries="$(STAGING_DIR)/usr/lib" \
-	--with-libpcre-includes="$(STAGING_DIR)/usr/include" \
-	--with-libpcre-libraries="$(STAGING_DIR)/usr/lib" \
-	--with-daq-includes="$(STAGING_DIR)/usr/include" \
-	--with-daq-libraries="$(STAGING_DIR)/usr/lib" \
+	--with-dnet-includes="$(STAGING_DIR)/opt/include" \
+	--with-dnet-libraries="$(STAGING_DIR)/opt/lib" \
+	--with-libpcap-includes="$(STAGING_DIR)/opt/include" \
+	--with-libpcap-libraries="$(STAGING_DIR)/opt/lib" \
+	--with-libpcre-includes="$(STAGING_DIR)/opt/include" \
+	--with-libpcre-libraries="$(STAGING_DIR)/opt/lib" \
+	--with-daq-includes="$(STAGING_DIR)/opt/include" \
+	--with-daq-libraries="$(STAGING_DIR)/opt/lib" \
 	--disable-static-daq
 
 ifeq ($(CONFIG_SNORT_MYSQL),)
@@ -77,91 +77,81 @@
 endif
 
 CONFIGURE_VARS += \
-	CPPFLAGS="$$$$CPPFLAGS -I$(STAGING_DIR)/usr/include/mysql" \
-	LDFLAGS="$$$$LDFLAGS -L$(STAGING_DIR)/usr/lib/mysql" \
-	PATH="$(STAGING_DIR)/usr/lib/libnet-1.0.x/bin:$$$$PATH"
+	CPPFLAGS="$$$$CPPFLAGS -I$(STAGING_DIR)/opt/include/mysql" \
+	LDFLAGS="$$$$LDFLAGS -L$(STAGING_DIR)/opt/lib/mysql" \
+	PATH="$(STAGING_DIR)/opt/lib/libnet-1.0.x/bin:$$$$PATH"
 
 MAKE_FLAGS += \
 	extra_incl=""
 
 define Build/InstallDev
-	$(INSTALL_DIR) $(STAGING_DIR)/usr/include/snort/dynamic_preproc
+	$(INSTALL_DIR) $(STAGING_DIR)/opt/include/snort/dynamic_preproc
 	$(CP) \
-		$(PKG_INSTALL_DIR)/usr/include/snort/dynamic_preproc/* \
-		$(STAGING_DIR)/usr/include/snort/dynamic_preproc/
-	$(INSTALL_DIR) $(STAGING_DIR)/usr/lib/snort/dynamic_preproc
-	$(CP) \
-		$(PKG_INSTALL_DIR)/usr/lib/snort/dynamic_preproc/* \
-		$(STAGING_DIR)/usr/lib/snort/dynamic_preproc/
-	$(INSTALL_DIR) $(STAGING_DIR)/usr/lib/snort_dynamicengine
-	$(CP) \
-		$(PKG_INSTALL_DIR)/usr/lib/snort_dynamicengine/* \
-		$(STAGING_DIR)/usr/lib/snort_dynamicengine/
-	$(INSTALL_DIR) $(STAGING_DIR)/usr/lib/snort_dynamicpreprocessor
+		$(PKG_INSTALL_DIR)/Apps/opt/include/snort/dynamic_preproc/* \
+		$(STAGING_DIR)/opt/include/snort/dynamic_preproc/
+	$(INSTALL_DIR) $(STAGING_DIR)/opt/lib/snort/dynamic_preproc
+	$(CP) \
+		$(PKG_INSTALL_DIR)/Apps/opt/lib/snort/dynamic_preproc/* \
+		$(STAGING_DIR)/opt/lib/snort/dynamic_preproc/
+	$(INSTALL_DIR) $(STAGING_DIR)/opt/lib/snort_dynamicengine
+	$(CP) \
+		$(PKG_INSTALL_DIR)/Apps/opt/lib/snort_dynamicengine/* \
+		$(STAGING_DIR)/opt/lib/snort_dynamicengine/
+	$(INSTALL_DIR) $(STAGING_DIR)/opt/lib/snort_dynamicpreprocessor
 	$(CP) \
-		$(PKG_INSTALL_DIR)/usr/lib/snort_dynamicpreprocessor/* \
-		$(STAGING_DIR)/usr/lib/snort_dynamicpreprocessor/
+		$(PKG_INSTALL_DIR)/Apps/opt/lib/snort_dynamicpreprocessor/* \
+		$(STAGING_DIR)/opt/lib/snort_dynamicpreprocessor/
 endef
 
 define Package/snort/conffiles
-/etc/config/snort
-/etc/snort/snort.conf
+/opt/etc/config/snort
+/opt/etc/snort/snort.conf
 endef
 
 define Package/snort/install
-	$(INSTALL_DIR) $(1)/usr/bin
+	$(INSTALL_DIR) $(1)/opt/bin
 	$(INSTALL_BIN) \
-		$(PKG_INSTALL_DIR)/usr/bin/snort  \
-		$(1)/usr/bin/snort
+		$(PKG_INSTALL_DIR)/Apps/opt/bin/snort  \
+		$(1)/opt/bin/snort
 
 	$(INSTALL_BIN) \
-		$(PKG_INSTALL_DIR)/usr/bin/u2{boat,spewfoo} \
-		$(1)/usr/bin
+		$(PKG_INSTALL_DIR)/Apps/opt/bin/u2{boat,spewfoo} \
+		$(1)/opt/bin
 
-	$(INSTALL_DIR) $(1)/usr/lib/snort_dynamicengine
+	$(INSTALL_DIR) $(1)/opt/lib/snort_dynamicengine
 	$(CP) \
-		$(PKG_INSTALL_DIR)/usr/lib/snort_dynamicengine/libsf_engine.so* \
-		$(1)/usr/lib/snort_dynamicengine/
+		$(PKG_INSTALL_DIR)/Apps/opt/lib/snort_dynamicengine/libsf_engine.so* \
+		$(1)/opt/lib/snort_dynamicengine/
 
-	$(INSTALL_DIR) $(1)/usr/lib/snort_dynamicpreprocessor
+	$(INSTALL_DIR) $(1)/opt/lib/snort_dynamicpreprocessor
 	$(CP) \
-		$(PKG_INSTALL_DIR)/usr/lib/snort_dynamicpreprocessor/libsf*.so* \
-		$(1)/usr/lib/snort_dynamicpreprocessor/
+		$(PKG_INSTALL_DIR)/Apps/opt/lib/snort_dynamicpreprocessor/libsf*.so* \
+		$(1)/opt/lib/snort_dynamicpreprocessor/
 
-	$(INSTALL_DIR) $(1)/etc/snort
+	$(INSTALL_DIR) $(1)/opt/etc/snort
 	$(INSTALL_CONF) \
 		$(PKG_BUILD_DIR)/etc/snort.conf \
-		$(1)/etc/snort/
+		$(1)/opt/etc/snort/
 	$(INSTALL_CONF) \
 		$(PKG_BUILD_DIR)/etc/attribute_table.dtd \
-		$(1)/etc/snort/
+		$(1)/opt/etc/snort/
 	$(INSTALL_CONF) \
 		$(PKG_BUILD_DIR)/etc/classification.config \
-		$(1)/etc/snort/
+		$(1)/opt/etc/snort/
 	$(INSTALL_CONF) \
 		$(PKG_BUILD_DIR)/etc/gen-msg.map \
-		$(1)/etc/snort/
+		$(1)/opt/etc/snort/
 	$(INSTALL_CONF) \
 			$(PKG_BUILD_DIR)/etc/reference.config \
-			$(1)/etc/snort/
+			$(1)/opt/etc/snort/
 	$(INSTALL_CONF) \
 		$(PKG_BUILD_DIR)/etc/unicode.map \
-		$(1)/etc/snort/
+		$(1)/opt/etc/snort/
 
-	$(INSTALL_DIR) $(1)/etc/snort/preproc_rules
+	$(INSTALL_DIR) $(1)/opt/etc/snort/preproc_rules
 	$(INSTALL_CONF) \
 		$(PKG_BUILD_DIR)/preproc_rules/*.rules \
-		$(1)/etc/snort/preproc_rules/
-
-	$(INSTALL_DIR) $(1)/etc/init.d
-	$(INSTALL_BIN) \
-		./files/snort.init \
-		$(1)/etc/init.d/snort
-
-	$(INSTALL_DIR) $(1)/etc/config
-	$(INSTALL_CONF) \
-		./files/snort.config \
-		$(1)/etc/config/snort
+		$(1)/opt/etc/snort/preproc_rules/
 endef
 
 $(eval $(call BuildPackage,snort))
